<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Admin View - Travel Insurance Request #{{ request.id }}</title>
    <style>
        @page {
            size: A4;
            margin: 1.5cm;
        }
        
        body { 
            font-family: Arial, sans-serif; 
            line-height: 1.6; 
            margin: 0;
            padding: 0;
            color: #333;
            font-size: 12px;
        }
        
        .header { 
            text-align: center; 
            margin-bottom: 25px; 
            border-bottom: 2px solid #2c3e50;
            padding-bottom: 15px;
        }
        
        .logo { 
            height: 70px; 
            margin-bottom: 10px;
        }
        
        h1 { 
            color: #2c3e50; 
            margin: 5px 0;
            font-size: 1.8em;
        }
        
        h2 {
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            font-size: 1.4em;
            margin-top: 30px;
            page-break-after: avoid;
        }
        
        .section { 
            margin-bottom: 30px;
            page-break-inside: avoid;
        }
        
        .footer { 
            position: fixed;
            bottom: 0;
            width: 100%;
            font-size: 0.8em;
            text-align: center;
            color: #777;
            border-top: 1px solid #eee;
            padding-top: 10px;
        }
        
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-bottom: 20px;
            page-break-inside: avoid;
        }
        
        th, td { 
            border: 1px solid #ddd; 
            padding: 8px; 
            text-align: left; 
            vertical-align: top;
        }
        
        th { 
            background-color: #f2f2f2; 
            font-weight: bold;
            width: 30%;
        }
        
        .document-image { 
            max-width: 100%; 
            max-height: 250px;
            height: auto; 
            margin-top: 10px; 
            border: 1px solid #ddd;
            display: block;
            page-break-inside: avoid;
        }
        
        .document-container { 
            margin-bottom: 25px;
            page-break-inside: avoid;
        }
        
        .document-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .status {
            padding: 3px 8px;
            border-radius: 3px;
            font-weight: bold;
            display: inline-block;
        }
        
        .status-pending {
            background-color: #FFF3CD;
            color: #856404;
        }
        
        .status-approved {
            background-color: #D4EDDA;
            color: #155724;
        }
        
        .status-rejected {
            background-color: #F8D7DA;
            color: #721C24;
        }
        
        .admin-note {
            background-color: #f8f9fa;
            padding: 10px;
            border-left: 4px solid #6c757d;
            margin: 10px 0;
        }
        
        .no-data {
            color: #777;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>TRAVEL INSURANCE REQUEST REPORT</h1>
        <p>Request #{{ request.id }} | Generated on {{ now.strftime('%Y-%m-%d %H:%M') }}</p>
    </div>
    
    <div class="section admin-info">
        <h2>Report Information</h2>
        <table>
            <tr>
                <th>Generated By</th>
                <td>{{ current_user.first_name }} {{ current_user.last_name }} (Admin ID: {{ current_user.id }})</td>
            </tr>
            <tr>
                <th>Report Date</th>
                <td>{{ now.strftime('%Y-%m-%d %H:%M') }}</td>
            </tr>
            <tr>
                <th>Request Status</th>
                <td>
                    <span class="status status-{{ request.status }}">
                        {{ request.status|upper }}
                    </span>
                </td>
            </tr>
            {% if request.processed_at %}
            <tr>
                <th>Processed Date</th>
                <td>{{ request.processed_at.strftime('%Y-%m-%d %H:%M') }}</td>
            </tr>
            {% endif %}
        </table>
    </div>
    
    <div class="section user-info">
        <h2>Client Information</h2>
        <table>
            <tr>
                <th>Client Name</th>
                <td>{{ request.user.first_name }} {{ request.user.last_name }}</td>
            </tr>
            <tr>
                <th>Client ID</th>
                <td>{{ request.user.id }}</td>
            </tr>
            <tr>
                <th>Email Address</th>
                <td>{{ request.user.email }}</td>
            </tr>
            <tr>
                <th>Contact Number</th>
                <td>{{ request.phone }}</td>
            </tr>
        </table>
    </div>
    
    <div class="section travel-details">
        <h2>Travel Details</h2>
        <table>
            <tr>
                <th>Destination</th>
                <td>{{ request.destination }}</td>
            </tr>
            <tr>
                <th>Departure Date</th>
                <td>
                  {% if request.departure_date %}
                    {{ request.departure_date.strftime('%Y-%m-%d') }}
                  {% else %}
                    N/A
                  {% endif %}
                </td>
            </tr>
            <tr>
                <th>Return Date</th>
                <td>
                  {% if request.return_date %}
                    {{ request.return_date.strftime('%Y-%m-%d') }}
                  {% else %}
                    N/A
                  {% endif %}
                </td>
            </tr>
            <tr>
                <th>Number of Travelers</th>
                <td>{{ request.travelers }}</td>
            </tr>
            <tr>
                <th>Coverage Type</th>
                <td>{{ request.coverage_type }}</td>
            </tr>
        </table>
        
        {% if request.admin_notes %}
        <h3>Administrator Notes</h3>
        <div class="admin-note">
            {{ request.admin_notes }}
        </div>
        {% endif %}
    </div>
    
    <div class="section documents">
        <h2>Supporting Documents</h2>
        
        <div class="document-container">
            <div class="document-title">Passport</div>
            {% if images.passport %}
                <img class="document-image" src="data:image/jpeg;base64,{{ images.passport }}" alt="Passport">
            {% else %}
                <p class="no-data">No passport provided</p>
            {% endif %}
        </div>
    </div>
    
    <div class="footer">
        <p>BIC Client Care System - Confidential Document</p>
        <p>Generated on {{ now.strftime('%Y-%m-%d at %H:%M') }} | Page <pdf:pagenumber/> of <pdf:pagecount/></p>
    </div>
</body>
</html>